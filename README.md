# Parking Environment Demo

This repository packages a modular parking environment, ready for interactive demos and steering-assist tuning. The workflow is built around a Conda environment (`parking-rl`) and a Jupyter notebook that orchestrates the individual scripts.

## Environment

- Conda version used: **25.7.0** (from Anaconda/Miniconda).
- Environment definition: [`environment.yml`](environment.yml).

Recreate the environment on a new machine:

```bash
conda env create -f environment.yml
conda activate parking-rl
```

If the environment already exists:

```bash
conda env update -f environment.yml --prune
conda activate parking-rl
```

Ensure Qt GUI support is available (the environment installs `pyqt>=5.15`). On headless Linux hosts you may need to export `QT_QPA_PLATFORM=offscreen` or use X11 forwarding.

## Project Layout

```
parking_project/
├── generate_training_config.py   # CLI to synthesize random training configs
├── main.py                       # CLI entry point for manual/random parking runs
├── parking_gym.py                # Gymnasium environment definition and helpers
├── steering_tuner.py             # Qt-backed Matplotlib tuner for steering assist
├── generated_configs/
│   ├── notebook_override.json    # Live-config edited by the notebook/tuner
│   └── train_001.json            # Sample training config generated by CLI
└── ParkingEnv_Demo.ipynb         # Notebook front-end controlling the entire demo

README.md                         # This file
environment.yml                   # Conda environment specification
```

The workflow is modular: JSON configs capture scenario parameters, the notebook drives high-level actions, and standalone scripts handle CLI demos and steering tuning.

## Usage

### 1. Launch the Notebook

Within the activated environment:

```bash
cd parking_project
jupyter notebook ParkingEnv_Demo.ipynb
```

The notebook guides you through:

1. Setting run parameters (episodes, max steps, mode).
2. Choosing or editing configuration JSON files.
3. Launching the steering tuner (`steering_tuner.py`) with Qt sliders for Kp/Kd/deadband.
4. Starting the CLI parking demo (`main.py`) in manual or random mode.

All key actions (writing configs, spawning CLI commands) are exposed as notebook cells; no direct script editing is required for normal usage.

### 2. Steering Assist Tuning (Command Line)

You can also launch the tuner from a terminal:

```bash
conda run -n parking-rl python steering_tuner.py \
  --config generated_configs/notebook_override.json \
  --angle0 20 --rate0 0 --steps 200 --sync
```

Sliders adjust the steering assist gains; when `--sync` is supplied, each adjustment writes back to the JSON file.

### 3. CLI Parking Demo

Run manual or random episodes without the notebook:

```bash
conda run -n parking-rl python main.py \
  --mode manual --episodes 1 --max-steps 4000 \
  --config generated_configs/notebook_override.json
```

Optional flags:

- `--mode random` for scripted random-agent control.
- `--sleep-scale <float>` to slow down or speed up animation.

### 4. Training Config Generator

Produce a fresh randomized config:

```bash
conda run -n parking-rl python generate_training_config.py \
  --out generated_configs/train_001.json
```

## Notes for Contributors

- The repo targets Python 3.8 for compatibility with Gymnasium 0.29.
- GUI windows rely on Matplotlib’s `QtAgg` backend.
- JSON configs embed bilingual notes; the steering tuner preserves UTF-8 characters on write.
- If you adjust parameters outside the notebook, ensure `--sync` is enabled when tuning to keep the JSON file up to date.

Happy parking!